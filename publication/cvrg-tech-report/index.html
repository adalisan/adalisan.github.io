<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.20.5" />
  <meta name="author" content="Sancar Adali">
  <meta name="description" content="Scientist">

  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="/css/highlight.min.css">
    
  
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather%7CRoboto+Mono">
  <link rel="stylesheet" href="/css/hugo-academic.css">
  

  <link rel="alternate" href="https://adalisan.github.io/index.xml" type="application/rss+xml" title="Sancar Adali - personal website">
  <link rel="feed" href="https://adalisan.github.io/index.xml" type="application/rss+xml" title="Sancar Adali - personal website">

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/apple-touch-icon.png">

  <link rel="canonical" href="https://adalisan.github.io/publication/cvrg-tech-report/">

  

  <title>Prediction of Heart Arrythmias | Sancar Adali - personal website</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Sancar Adali - personal website</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#publications_selected">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#links">
            
            <span>Links</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
          </a>
        </li>

        
        

        
      </ul>

    </div>
  </div>
</nav>

<div class="pub" itemscope itemtype="http://schema.org/CreativeWork">

  

  <div class="container pub-title">
    <h1 itemprop="name">Prediction of Heart Arrythmias</h1>
    <span class="pub-authors" itemprop="author">
      
      Sancar Adali
      
    </span>
    <span class="pull-right">
      
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fadalisan.github.io%2fpublication%2fcvrg-tech-report%2f"
         target="_blank">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Prediction%20of%20Heart%20Arrythmias&amp;url=https%3a%2f%2fadalisan.github.io%2fpublication%2fcvrg-tech-report%2f"
         target="_blank">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fadalisan.github.io%2fpublication%2fcvrg-tech-report%2f&amp;title=Prediction%20of%20Heart%20Arrythmias"
         target="_blank">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2fadalisan.github.io%2fpublication%2fcvrg-tech-report%2f&amp;title=Prediction%20of%20Heart%20Arrythmias"
         target="_blank">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Prediction%20of%20Heart%20Arrythmias&amp;body=https%3a%2f%2fadalisan.github.io%2fpublication%2fcvrg-tech-report%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


    </span>
  </div>

</div>
<div class="article-container">

  

  <h3>Abstract</h3>
  <p class="pub-abstract" itemprop="text"></p>

  
  <div class="row">
    <div class="col-sm-1"></div>
    <div class="col-sm-10">
      <div class="row">
        <div class="col-xs-12 col-sm-3 pub-row-heading">Type</div>
        <div class="col-xs-12 col-sm-9">
          
          <a href="/publication/#3">
            Work in progress
          </a>
          
        </div>
      </div>
    </div>
    <div class="col-sm-1"></div>
  </div>
  <div class="visible-xs space-below"></div>
  

  <div class="row">
    <div class="col-sm-1"></div>
    <div class="col-sm-10">
      <div class="row">
        <div class="col-xs-12 col-sm-3 pub-row-heading">Publication</div>
        <div class="col-xs-12 col-sm-9">Technical Report Draft</div>
      </div>
    </div>
    <div class="col-sm-1"></div>
  </div>
  <div class="visible-xs space-below"></div>

  <div class="row">
    <div class="col-sm-1"></div>
    <div class="col-sm-10">
      <div class="row">
        <div class="col-xs-12 col-sm-3 pub-row-heading">Date</div>
        <div class="col-xs-12 col-sm-9" itemprop="datePublished">
          May, 2017
        </div>
      </div>
    </div>
    <div class="col-sm-1"></div>
  </div>
  <div class="visible-xs space-below"></div>

  <div class="row" style="padding-top: 10px">
    <div class="col-sm-1"></div>
    <div class="col-sm-10">
      <div class="row">
        <div class="col-xs-12 col-sm-3 pub-row-heading" style="line-height:34px;">Links</div>
        <div class="col-xs-12 col-sm-9">

          




<a class="btn btn-primary btn-outline" href="https://adalisan.github.io/">
  PDF
</a>


<a class="btn btn-primary btn-outline" href="https://adalisan.github.io/">
  Slides
</a>


<a class="btn btn-primary btn-outline" href="https://adalisan.github.io/">
  Video
</a>


<a class="btn btn-primary btn-outline" href="https://adalisan.github.io/">
  Code
</a>


<a class="btn btn-primary btn-outline" href="https://adalisan.github.io/">
  Dataset
</a>


<a class="btn btn-primary btn-outline" href="https://adalisan.github.io/project/JOFC">
  Project
</a>




        </div>
      </div>
    </div>
    <div class="col-sm-1"></div>
  </div>
  <div class="visible-xs space-below"></div>

  <div class="space-below"></div>

  <div class="article-style">

<h2 id="introduction-introduction-unnumbered">Introduction {#introduction .unnumbered}</h2>

<p>In large studies of cardiovascular disease, there are usually multiple sources of data for subjects, including  ECG measurements, genotype information and various marker loci, measurements of proteomic biomarkers, MRI and CT images, age, gender, ethnicity, and results of additional  Clinical evaluation. Our motivation for this study was to develop statistical tools for integrating available patient data from several such modalities and scales in order to classify patients according to their risk of sudden cardiac death (SCD). In order to tailor classical machine learning tools to this problem, we have developed new methodology using data from subjects in the Reynolds project. These subjects have been implanted with defibrillators when they are considered at high risk for SCD from heart arrhythmia. Since these devices are implanted at considerable financial cost as well is inconvenience to patients, and can have a significant effect on quality of life, it is evidently desirable to determine for which patients, if any, implantation can be safely avoided. In particular, we have focused on developing predictors with high sensitivity, in the sense of identifying patients who should be implanted due to high risk of SCD, at the possible expense of specificity, in the sense of implanting patients who perhaps need not be implanted due to low risk of SCD.</p>

<p>To pin down the phenotype to be predicted, we limit the dataset to only patients who have been observed up to a certain number of days(referring to this parameter as <em>ndays</em>). Among this population of interest, the phenotype is determined by whether the patient has survived <em>ndays</em> after their date of implantation.</p>

<h2 id="medical-background-medical-background-unnumbered">Medical Background {#medical-background .unnumbered}</h2>

<p>Sudden cardiac death is a leading cause of death in patients with heart failure. It is generally defined as natural death due to cardiac reasons within a short time of onsetting symptoms without previous immediately fatal conditions@Zipes1998 [@Lopshire2006]. It occurs five to six times often in patients with previous heart failure than the general population. Although research on the mechanism of this event is still undergoing@Lopshire2006, it is accepted that majority of these events are caused by abnormalities of electrical activity in the heart called arrhythmias. The occurrence of these abnormalities could be due to electrochemical and/or biological. These heart arrhythmias are classified according to the period of occurrences of certain patterns in the signal (tachycardia or fibrillation) and the physical location of the abnormal electrical signal in the heart (ventricular or atrial). Ventricular tachycardia and fibrillation are the more serious conditions, compared to atrial events. Ventricular tachycardia is identified with increase in heart rate. If VT is not terminated either naturally or by a medical response, it will turn into a ventricular fibrillation(VF) which is the medical term for irregular electrochemical signals in the heart, and uncontrolled convulsions of the heart muscle. This event causes the heart to lose its blood-pumping capacity. Therefore it is life-threatening and needs to be dealt with immediately with CPR or defibrillation.</p>

<p>To respond to heart arrhythmias , implantable cardioverter-defibrillators(ICD) are implanted to patients who have suffered a myocardial infarction(heart attack). These devices either shock the heart with a powerful pulse signal, or apply a fast electrical signal synchronized to heart rhythm to bring the heart rhythm to normal patterns. It has been established @Bardy2005 that they increase survival rates for patients (The ICD-implanted group had higher survival rates with respect to control group and patients taking anti-arrhythmia drugs), although it might be necessary to do further risk stratification, since the utilization rate is low. These devices carry a financial cost as long as a psychological cost to patients.</p>

<p>It should be noted that any study of Sudden Cardiac Death begs the question of what the definition of SCD is. The question is widely discussed in medical literature and different experts disagree on which mortality events should be labeled as SCD or not0. According to AHA:</p>

<p>“Sudden cardiac death (also called sudden arrest) is death resulting from an abrupt loss of heart function (cardiac arrest). The victim may or may not have diagnosed heart disease. The time and mode of death are unexpected. It occurs within minutes after symptoms appear. “. The specifics of the question is widely discussed in medical literature @Tomaselli2004. Our work mainly considers total mortality as a surrogate for SCD. @Zipes1998 argues any noticeable symptoms a patient has during the onset as too ambiguous and considers only information from  ECGs or ventricular electrograms from ICDs as definitive. They suggest considering total mortality as the outcome in studies.</p>

<p>Our initial prediction task is to use different biomarkers and  Clinical variables to accomplish the risk quantification of life-threatening heart arrhythmias. A measure of risk as computed with the help of biomarkers would have quite large practical value, since it would help health care professional with an objective means to decide whether to implant the ICD device to a person or not.</p>

<p>Various biomarkers , including ejection fraction and inducibility in EPS@Buxton2002 testing have been shown to be associated with heart arrhythmia events, although the results from some of the biomarker studies have ambiguous results and have not survived scrutiny from repeated medical studies.</p>

<p>Ejection Fraction is a biomarker that is a measure of the heart’s blood-pumping capability. It is defined as the difference between largest and smallest volume of the left ventricle (bottom heart chamber). If this measure is too low, the heart is not contracting properly and can not pump enough blood to the body. The volume of the left ventricle can be computed from MRI images or visually estimated from ultrasound images(the former is more accurate).</p>

<p>Inducibility is the result of an inducible arrhythmia test(also called electrophysiological study or test(EPS)). This test involves a physician while monitoring the electrical activity in the heart, trying to induce an arrhythmia by drugs or electrical current. While minimally invasive, the prognostic value of this test is in question. During EPS-electrophysiologic testing, which is also called “programmed ventricular stimulation(PVS),’ different kinds of arrhythmias can be induced.</p>

<p>The possible types of induced arrhythmias:</p>

<ul>
<li><p>Monomorphic Ventricular Tachycardia(MMVT)</p></li>

<li><p>Polymorphic Ventricular Tachycardia(PMVT)</p></li>

<li><p>Ventricular Fibrillation(VF)</p></li>
</ul>

<p>Shocks from ICDs (Firing) take place, when patient’s heart rate, as detected from the leads of the device which monitor the electrical signals, passes a threshold. This might happen due to an atrial arrhythmia which is not life-threatening. In this case, the firing is labeled as inappropriate. Inappropriate firings are unnecessary utilization of the devices which cause great distress to the patients.</p>

<p>Although ventricular electrograms that shows how the arrhythmias progressed that led to (or might have led to) death might available in implanted ICDs in Reynolds study, these data need to be adjudicated to be classified into one type of arrhythmia or another. Once an arrhythmia is classified, it is possible to decide whether the ICD firing was appropriate or not. The adjudication in Reynolds study is done by the Reynolds study committee. We have this information in Reynolds dataset available for most of the patients who had ICD devices fire. Investigations for appropriate firing as the outcome did not lead to any significant results.</p>

<h2 id="the-reynolds-dataset-the-reynolds-dataset-unnumbered">The Reynolds Dataset  {#the-reynolds-dataset .unnumbered}</h2>

<p>Reynolds dataset comes from a cohort of patients from Johns Hopkins University and &hellip; centers that have been implanted by ICD devices. The cohort consists of 664 patients from Johns Hopkins, 21 from QCD, 96 from UMD, 73 from VCU and 305 from WHC. Various biomarkers and  Clinical information is collected from the cohort and we utilize as much of this data as possible in our analysis. Some of the subjects do not have implantation data available (patients from centers other than JHU) and we remove these from the study.</p>

<p>The biomarkers are collected via various tests and measurements carried out in Reynolds study using various technologies: Electrocardiogram signal recordings, Single Nucleotide Polymorphism analysis, computerized analysis of Magnetic Resonance  Imaging images, quantitative analysis of blood proteins. These different modalities are referred to as  ECG,  SNP,  Imaging, PROTEIN and  Clinical(which include information such as age, gender, ethnicity and also a doctor-provided estimate of ejection fraction).</p>

<p>An important challenge of the dataset is that all of the tests have not been carried out for all of the subjects. For any subject, all features in a modality might be missing, because that subject did not undergo that particular test. In fact, nearly half of the cohort have not had MRI images collected. Limiting data analysis to subjects who have all of the modalities available would severely decrease the sample size and remove any chance of detecting a class-feature correlation in the data that is generalizable.</p>

<p><img src="FiveModalVenn" alt="Venn diagram with areas proportional to subject counts having those modalities available" /></p>

<p>For each modality, the following categorical and continous features are available:</p>

<pre><code>Name    Description    Categorical or Continuous    Suggested by experts  
-----  --------------- -------------------------    --------------------
SNP     SNP1    rs16847548    Categorical    Yes  
SNP     SNP2    rs4657139    Categorical    Yes  
SNP     SNP3    rs12567209    Categorical    Yes  
SNP     SNP4    rs12567211    Categorical      
SNP     SNP5    rs1415262    Categorical      
SNP     SNP6    rs10494366    Categorical    Yes  
ECG    meanHRbpm    Mean Heart Rate (beats per minute)    Continuous      
ECG    perckept,       Continuous      
ECG    percPVC    Percentage ectopic in the epoch    Continuous      
ECG    QTVI\_log    log of the QT variability Index(= log ((QTvariance/(QTmean2))/(RRvariance/RRmean2)))    Continuous    Yes  
ECG    QTVInumer.1000    QT Variability/Mean-Squared QT    Continuous      
ECG    QTVIdenom.1000    RR Variability/Mean-Squared RR    Continuous      
ECG    QTV\_msecsqu    QT Variability ($milisec^{2}$)    Continuous      
ECG    HRV\_bpmsqu    from Heart Rate Variability (HRV) spectral analysis,    Continuous      
ECG    QTintmean\_sec    QT interval mean ($sec$)    Continuous    Yes  
ECG    HRmean\_bpm    Heart Rate mean    Continuous      
ECG    QTRRslope    Slope of the QT vs RR regression plot    Continuous      
ECG    QTRRintercept    Intercept of the QT vs RR regression plot    Continuous      
ECG    QTRR\_r2    $R^{2}$ value of the fitted QT vs RR regression plot    Continuous      
ECG    meancoh    mean spectral coherence of QT and HR    Continuous      
ECG    VLFPow    from HRV spectral analysis, Very Low Frequency Power,    Continuous      
ECG    LFPow,    from HRV spectral analysis, Low Frequency Power,    Continuous      
ECG    HFPow,    from HRV spectral analysis, High Frequency Power    Continuous      
ECG    TotPow\_ Clinical\_use,    from HRV spectral analysis, the sum of Very Low Frequency Power, Low Frequency Power, High Frequency Power    Continuous      
ECG    TotPow\_mathematical    Correlated with TotPow\_ Clinical\_use    Continuous      
ECG    LFdivHFPow,    HRV Low Frequency Power divided by High Frequency Power    Continuous      
ECG    LFdivHFplLF,    HRV Low Frequency Power divided by ( High Frequency Power + Low Frequency Power )    Continuous    Yes  
ECG    RMSSD\_msec,    results for these standard definitions of linear HRV analysis    Continuous      
ECG    pNN50,    standard definitions of linear HRV analysis    Continuous      
ECG    meanNN\_msec    standard definitions of linear HRV analysis: Mean of normal RR interval in milliseconds    Continuous    Yes  
ECG    , SDNN\_msec,    standard definitions of linear HRV analysis:Standard Deviation of normal RR interval in milliseconds    Continuous    Yes  
ECG    total\_RRvariance\_msec,    RR Variance in milliseconds    Continuous      
ECG    SDNN\_RST\_msec,    S.D. of Normal RR in Regional Spectral Turbulence    Continuous      
ECG    sdRLTESQTintmsec    S.D. of QT Interval    Continuous      
ECG    ,avgNssvthoseelim,    the average noise (normalized-epsilon)\
</code></pre>

<p>value of the bad QT beats    Continuous<br />
    ECG    avgNssthosekept    Average Noise Power for Good QT Beats    Continuous<br />
    ECG    cardiom.type    Cardiomyopathy Type: Whether Ischemic disease or not    Categorical<br />
    ECG    Inducible    Whether the subject underwent heart arrhythmia during electrophysiological test    Categorical    Yes<br />
    ECG    MMVT    Whether the subject underwent MMVT type heart arrhythmia during electrophysiological test    Categorical<br />
    Imaging    LVEDV    Left Ventricular end-diastole volume (ml) -volume of left ventricular chamber at maximum dilation phase (largest volume)    Continuous    Yes<br />
    Imaging    LVESV    Left Ventricular end-systole volume (ml) - volume of left ventricular chamber at maximum contraction phase (smallest volume)    Continuous<br />
    Imaging    LVEF    Left Ventricular Ejection Fraction $\frac{LVEDV-LVESV}{LVEDV}*100$ measured by MRI    Continuous    Yes<br />
    Imaging    LVEDMASS    left ventricle end-diastole mass - myocardial mass at end-diastole (g)    Continuous<br />
    Imaging    DEmass    mass of tissue exhibiting delayed enhancement. This is typically infarct scar or fibrotic regions.    Continuous    Yes<br />
    Clinical    EchoEF ,    Left Ventricular Ejection Fraction Measured by Ultrasound    Continuous    Yes<br />
    Clinical    Age.At.Implant ,    Age of Subject at Time of Implantation    Continuous    Yes<br />
    Clinical    Race”,    Ethnic Background, one of B,A,W,O    Categorical    Yes<br />
    Clinical    Gender    Gender    Categorical    Yes<br />
   Protein Biomarkers    HS.CRP,    High-sensitivity C-reactive protein test    Continuous    Yes<br />
   Protein Biomarkers    TNF.a.Rec.2    TNF$-\alpha$ Soluble TNF$-\alpha$ receptors 1 and 2 test    Continuous    Yes<br />
   Protein Biomarkers    HSIL.6,    High-sensitivity Soluble IL-6 receptor test    Continuous    Yes<br />
   Protein Biomarkers    Pro.BNP,    N-terminal pro b-type natriuretic peptide test    Continuous    Yes<br />
   Protein Biomarkers    Il.10 ,    Interleukin-10 test    Continuous    Yes<br />
   Protein Biomarkers    CTNT,    Cardiac troponin T test    Continuous    Yes<br />
   Protein Biomarkers    CKNB,    Creatine Kinase MB Isoenzyme test    Continuous    Yes<br />
   Protein Biomarkers    Myoglobin    Myoglobin test    Continuous    Yes<br />
   Protein Biomarkers    Tropin.I    Troponin I test    Continuous    Yes</p>

<h2 id="previous-work-previous-work-unnumbered">Previous Work {#previous-work .unnumbered}</h2>

<p>There exists many studies about risk factors and prognostic biomarkers for SCD in cardiovascular community. Previous work that shares our initial objective of discovering biomarkers to predict heart arrhythmias that ICDs will prevent include @Arking2006 [@Catanzaro2007; @Cook2009; @Fisher2005; @Greenberg2004; @Imaki2005; @Kies2004; @Klein2006]. Various studies try to study the prognostic value of electrophysiological testing(EPS)@Bhandari1989 [@Brembilla-Perrot1995; @Buxton1987; @Buxton2000; @Carrillo; @Daubert2006; @DeFerrari2007; @Denniss1986; @DiMarco2001]. It is not established whether inducibility in EPS corresponds to a higher risk of SCD or higher ICD firing rate. @Schmitt2001 report: “Due to positive results in early studies the inducibility has been incorporated into some of the ICD studies despite</p>

<ul>
<li><p>conflicting results regarding the predictive power</p></li>

<li><p>debate over whether comparable information can be taken from a combination of noninvasive tests</p></li>

<li><p>low predictive value@Bourke1991</p></li>

<li><p>the invasive nature associated with potential morbidity.</p></li>
</ul>

<p>”</p>

<p>A relatively rarely seen condition that causes arrhythmias is Long QT syndrome (LQTS) which is a congenital or drug-induced condition @Berger2010. Deviation of QT interval is seen as possible trigger of events leading to arrhythmias.</p>

<p>Other warning signs of arrhythmias include “scalar electrical abnormalities such as microvolt T-wave alternans, increased QRS duration, and repolarization abnormalities disordered autonomic nervous system function manifested by alteration and variability in resting and exercising heart rate and baroreflex sensitivity, and the presence of occult ventricular arrhythmias”.@Lopshire2006</p>

<p>Various studies(such as MADIT@Moss1996 [@Moss2003], MUSTT(@Buxton1999),SCD-HEFT@Bardy2005) have shown ICDs increase the survival rates of at-risk populations(both when the outcome is total mortality and SCD). All these studies consider specific subpopulations that are considered high-risk(These might be populations with low LVEF, Inducibility in EPS, coronary heart disease, ischemic or nonischemic cardiomyopathy). Such risk stratification is almost standard in medical studies. It is possible that there are interactions between biomarkers or  Clinical variables that determine the prognostic effectiveness of the biomarkers. For example, each feature might be separately not associated with the phenotype, but using them in conjunction might result in a good predictor of phenotype. Population stratification will make the interaction between such variables visible. Our choice of classifier, decision trees, will also discover such interaction between prognostic variables.</p>

<p>It is the opinion of @Lopshire2006 :</p>

<p>“It is clear from these and other studies that better understanding of the contribution of molecular and genetic/proteomic influences on the risk for developing, or for not developing, ventricular tachyarrhythmias, as well as understanding the mechanisms responsible for the onset and maintenance of arrhythmias in a variety of animal models, including human beings, is essential to both identify individuals at risk and to develop specific therapies to mitigate that risk. However, the future holds great promise, with advances in  Imaging capabilities and genetics, pharmacotherapy, and device technology, all playing increasing roles.”</p>

<p>What motivated our investigations was to combine these different information from these modalities to have a risk quantification toolbox that provides simple, interpretable results for cardiovascular researchers. It is our hope that the methodology and software tools we have developed will start an effort to treat the biomarker and  Clinical information as features from different modalities and possibly interacting predictors of risk.</p>

<p>The distinction between significance in association tests and good performance as a predictor is described in@Ware2006. This is one of our arguments machine learning tools we provide can be useful in the practical sense, since the training algorithms consider generalizability to the whole population,the classifiers are trained to have the best prediction performance. The features who seem to have correlation with the phenotype, but do not contribute to performance are not used in the classifiers. Same arguments are made in @Pepe2004.</p>

<h2 id="contributions-contributions-unnumbered">Contributions {#contributions .unnumbered}</h2>

<p>Our contributions are in two different fields: medical prognostics and machine learning .In this article, we will describe our contributions to cardiovascular research community and machine learning community. We address the “coherently” missing data problem in machine learning. Our method is comparable to previous methods available for handling missing data (such as probabilistic split of C4.5 and surrogate variables in CART decision tree algorithms) in terms of performance. The main reason for this novel way of handling missing data is that unlike most investigations in machine learning , our aim is not only to design and test a classifier algorithm, but also to find biomarkers that will predict a medical event. Due to the fact that we train our classifier using dataset provided by the Reynolds study which were carried out by medical personnel, the process that determines the missingness of a feature(biomarker) value(whether a patient undergoes the test for that biomarker, whether the test gives an unambigous and valid answer) might be specific to the medical protocol established by the study committee, and the protocol for testing multimodal biomarkers in heart patients is in no way fully established in the community. In order to preserve generalizability of our results to other datasets and general population, we make the assumption that missingness of any feature is not informative with respect to phenotype. It is possible we sacrifice some accuracy in performance <em>in this particular dataset</em> for sake of integrity of the medical conclusions of our investigations.</p>

<p>Although missing data is a common problem, the coherence of the missing data seen in Reynolds dataset and other biomedical dataset that contains multimodal biomarkers makes our problem unique. Our two novel decision tree algorithms provide a way to address the missing data problem, even when large fraction of data missing(up to 50% for some feature modalities), by leveraging the coherence of the missing data. By coherence, we refer to the fact that nearly all missing data belong to subjects who have no data for all of the features in one or more of the modalities.</p>

<p>Although many individual biomarkers have been identified as valid prognostic variable for predicting SCD, to our knowledge there have not been a study which aims to combine the predictive power of biomarkers of differing modalities. The usual approach of stratifying the population according to a  Clinical variable(age,gender, ethnicity) and carrying out association or survival analysis techniques in the medical research community has led to many discoveries in diagnosis of health problems. Applying machine learning tools for prediction of disease risk provides an integrated picture of the relationship between the phenotype and the biomarkers, especially for interpretable classifiers such as decision trees. In fact, the interpretability motivated our decision to use decision trees.</p>

<p>The most important of our methodology contributions to the cardiovascular research is in the form of a set of decision tree algorithms that are appropriate for learning from multimodal biomedical datasets and decision making. Another contribution is a decision tree that was learned from Reynolds dataset that performs better than the current biomarker used (ejection fraction) in deciding to implant a person with a ICD device.</p>

<h2 id="association-testing-of-features-with-death-and-appropriate-firing-association-testing-of-features-with-death-and-appropriate-firing-unnumbered">Association Testing of Features with Death and Appropriate Firing {#association-testing-of-features-with-death-and-appropriate-firing .unnumbered}</h2>

<p>Survival analysis techniques were utilized to detect association of features with death and appropriate firing. Univariate Cox models were fitted, and p-value of Wald Tests are computed for each model. The tables present features that are significant at a level of 0.01.</p>

<pre><code>  Feature            exp-coef   p.value   samp.size
------------------- ---------- --------- -----------
2 QTVI\_log              1.51      0.01      521.00
3 DEmass                 1.02      0.01      173.00
4 HS.CRP                 1.02      0.00      567.00
5 TNF.a.Rec.2            1.00      0.00      567.00
6 HSIL.6                 1.01      0.00      566.00
7 Pro.BNP                1.02      0.00      567.00
8 CTNT                   1.14      0.00      566.00
9 Age.At.Implant         1.04      0.00      477.00
</code></pre>

<p>These features were used in a multivariate Cox model , by incrementally adding each feature to the model, until at least one p-value for the coefficient for a feature became non-significant. The following table shows the summary from the final model.</p>

<pre><code>                 coef   exp(coef)   se(coef)      z   Pr($&gt;$$|$z$|$)
</code></pre>

<hr />

<pre><code>   TNF.a.Rec.2   0.00        1.00       0.00   4.36          1.3e-05
        HSIL.6   0.01        1.01       0.00   2.47            0.014
Age.At.Implant   0.03        1.03       0.01   3.14           0.0017
</code></pre>

<p>: Multivariate Cox Model Fit</p>

<p>Figures [fig:Kaplan-MeierCurve1][fig:Kaplan-MeierCurve2] [fig:Kaplan-MeierCurve3]show the two Kaplan-Meier plots for the three continuous features in the final multivariate Cox model. Each curve is the KM curve for one of the subpopulations: the subpopulation for which the biomarker value is lower than the median for the whole population, and that for which the biomarker value is higher than the median(NAs are removed).</p>

<p><img src="TNFlyxdot alyxdot Reclyxdot 2-KM-plot" alt="\[fig:Kaplan-MeierCurve1\]" /></p>

<p><img src="HSIL_6-KM-plot" alt="\[fig:Kaplan-MeierCurve2\]" /></p>

<p><img src="Age_At_Implant-KM-plot" alt="\[fig:Kaplan-MeierCurve3\]" /></p>

<h2 id="tools-sub-tools-toolssubtools-unnumbered">Tools[sub:Tools] {#toolssubtools .unnumbered}</h2>

<p>Decision Trees are machine learning tools that are widely used in classification and regression tasks. Their popularity is due to conceptual simplicity, interpretability and the large class of possible decision boundaries they can portray. Since we have defined a binary phenotype as the dependent variable to be predicted, we’ll be using classification trees. However, regression and classification trees are not really different in terms of training and prediction steps. In fact, the prediction given by our decision trees can be interpreted as either a risk score, or an estimated probability of an SCD event.</p>

<p>Various other aspects of this study, and the data collected herein, have driven our design of methodology: It is necessary to merge data on subjects from several different modalities, including  SNP,  ECG, and IMAGE measurements. Whereas data from at least one such modality is available for most of the subjects, there are only a small number of subjects with data for all modalities; consequently, missing data is more the rule than exception.. The missing data problem is a common problem in the field of machine learning and various approaches to deal with it have already been tried and tested. Our case is unique in that the missingness is not sporadic. It is not only common, but also repeated across features in a modality. Due to the federated collection of data in the Reynolds dataset (and many other data collected for medical studies), a lot of N/As appear in a patterned way. That is , for some patients, ALL of the features in some modalities have non-NA values while ALL the features in the remaining modalities are NA. Depending on the modality a feature belongs to, some features might be missing in half of the Reynolds cohort. The systematically missing data necessisates a novel decision tree algorithm, in order to deal with cases where such a big fraction of data is missing(In Reynolds dataset, up to 50% for some feature modalities might be missing).</p>

<h3 id="the-classical-classification-tree-model .unnumbered">The classical classification tree model</h3>

<p>In a classification tree, the dependent variable is discrete, usually binary. By splitting dataset to more pure ones in terms of the dependent variable, the model can find the most effective variables by which it uses for dividing. When certain purity is reached, the model stops splitting, then we call the stop point a leaf. Each splitting is called branches. In the tree structures, leaves represent classifications and branches represent conjunctions that lead to those classifications. Now, lets look at an example. Suppose $Y$ is dependent variable (binary), $X<em>{1}$, $X</em>{2}$, $X<em>{3}$, $X</em>{4}$ and $X<em>{5}$ are independent variables which are used to predict Y. First, the model tries to find the best variable $X</em>{i}$ among $X<em>{1}$ to $X</em>{5}$ and critical value $A$, so that when dividing the whole dataset to two datasets based on the criteria $X\geq A$ or $X&lt;A$, the purities of two new datasets are the highest. Lets say, $X_{1}$ is such a variable. Then we have:</p>

<p><img src="Image001" alt="image" /></p>

<p>Now repeat the procedure to each sub dataset (nod) until every sub dataset reaches certain pre-specified purity. So we have a list of variables which we use to divide the dataset. We also have a series of critical values ($C<em>{1}$, $C</em>{2}$, $C_{3}$…) which correspond to each splitting $j$. In the end we have tree graph like this.</p>

<p><img src="Image002_2" alt="image" /></p>

<p>At each leaf, the purity of $Y$ is above certain level, and we have posterior distributions of $Y$ given the series of conditions (e.g. $X<em>{1}&lt;A$, $X</em>{2}\geq C$ and so on). So we can estimate $Y$ based on $X<em>{1}$ to $X</em>{5}$. Please note that not all the variables have to be used in the analysis. The program only picks the best variables to split the dataset. It is very possible that several variables are not picked. For example, in the diagram above, $X_{3}$ is not used anywhere in the analysis.</p>

<p>The algorithms we have developed and proposed for dissemination are all written in the R programming language and build on various existing R packages.</p>

<h2 id="phenotype-sub-phenotype-phenotypesubphenotype-unnumbered">Phenotype[sub:Phenotype] {#phenotypesubphenotype .unnumbered}</h2>

<p>The definition of the classification problem should be considered carefully. As in a lot of bioinformatics applications, the real-life problem is a lot more complicated than a typical $2-class$ or $n-class$ classification problem. Each patient should be assignable to one of the classes. Some of the considerations when defining the classes are interpretability and practical value to the cardiovascular community. A practical issue is whether that the class a patient is assigned to can be inferred from the available information in the dataset.</p>

<p>Although the initial version of our prediction task was to predict ,the group of patients for whom an ICD device is really necessary among patients who have been implanted by the device . This aim is vague in its definition of “necessary” due to several reasons,</p>

<p>Just because the ICD has not been utilized up to a time point, does not mean it’s not going to be utilized later on. The ICD might have fired, but this might be due to a malfunction of the its sensors, or arrhythmia events not treatable by the therapy administered by the device.</p>

<p>Therefore, we propose modification of the prediction task as predicting the following defined phenotype.</p>

<p>$$\begin{cases}
0 | \mbox{If the patient is alive after 545 days after the implantation of ICD device}<br />
1 | \mbox{If the patient has died within 545 days after the implantation of ICD device}\end{cases}$$</p>

<p>An inevitable effect of the definition of the phenotype is the removal of subjects from the dataset for whom the phenotype is not defined. For example, any patient who is alive a year after his/her implantation, but have been censored before their status at 545 days (after implantation) becomes known has to be removed from the study, due to their phenotype being unknown. Consider a patient who has died within 545 days since implantation, but have been implanted recently,say 150 days before the end of the study(or today if the study is undergoing): the phenotype will be defined for this patient and will equal to 1 . In contrast, a patient which possibly belongs to the other class, and which has been implanted 150 days before the end of the study will be removed from the dataset. This will create a bias in the dataset, as instances of one class belonging to a random subset of dataset(the implantation date has no effect on the phenotype) are removed, while the instances of the other class belonging to the same subset are kept. To remove this bias, we only include subjects who have been observed for at least 545 days in the study, so that instances of either class are removed when they belong to the random subset defined by the date of implantation.</p>

<h2 id="classifiers-classifiers-unnumbered">Classifiers {#classifiers .unnumbered}</h2>

<p>Two novel decision tree structures are used. These trees are designed to handle our unique problem of systematically missing data.</p>

<ol>
<li><p>Trees with Substitute sub-trees</p></li>

<li><p>Modality-Based Trees</p></li>
</ol>

<p>In each fold of cross-validation, decision trees with one of the two structures are generated and validated on the left-out portion of the dataset. The validation instances are given a risk score based on the leaf node they end up in. Sensitivity/Specificity points are computed for varying decision thresholds for binarizing the risk scores into two class labels of the phenotype.</p>

<ul>
<li><p>For each run of cross-validation, sim =1:NUM_SIMS</p>

<ul>
<li><p>Create a N-partition of 1:NUM_SAMPLES</p></li>

<li><p>For each part of the N-partition, k = 1:N</p></li>

<li><p>Designate samples in kth part(left-out samples) as the validation set</p></li>

<li><p>Designate remaining samples as the training set.</p></li>

<li><p>Train the decision tree on the training set (Using algorithms 2 and 3 for tree of the first kind, and the second kind.</p></li>

<li><p>For each threshold value t = t_1: t_L</p>

<ul>
<li><p>For each left-out sample</p>

<ul>
<li><p>Determine the leaf node the sample end up in, by traversing down the tree according to its feature values.</p></li>

<li><p>Compare the class distribution of the training set in the leaf node with the threshold value t to decide on the class prediction.</p></li>
</ul></li>

<li><p>Compute the performance measures for threshold t based on the class predictions and the class labels</p></li>
</ul></li>
</ul></li>
</ul>

<ol>
<li><p>Trees with Substitute sub-trees: These are ternary decision trees. Each query of feature value has three possible answers: True(Discrete feature value is equal to the value in the query, or Continuous feature value is less than or equal to given threshold in the query),False(Discrete feature value is NOT equal to the value in the query, or Continuous feature value is NOT less than or equal to given threshold in the query) or N/A(Feature value is not available). During training, all the population in a node gets “copied” to the NA node(say “Node 1”) to find another split ( a <em>substitute</em> split) that is appropriate for the population. Since the missingness is common across all of the features in a modality, if the <em>substitute</em> split uses a feature in the same modality as the feature used in the previous split, the same set of instances that is missing the features in the modality will be sent to child NA node(say “Node 2”). If any such instance was used as a test instance, it would be never asked a real question, since it would be sent down to NA branches at all of the splits . To overcome this problem, the set of features that are considered for the <em>substitute</em> split are a reduced set of the original set of features: All features belonging to the same modality of the original feature are removed from the set of features that will be considered in any further splits(all of the splits in the subtree whose root node is the NA node). In the figure below, Feature 2 is selected from the features in the modalities other than the one containing Feature 1.</p>

<ol>
<li><img src="na_tree_subst_depth2" alt="" /></li>
</ol>

<p>One of the stopping criteria of this algorithm has to do with a node property called “real depth” which is the number of non-NA answers to the split questions that have been asked starting from the root node and ending up in the node in question. Since NA values are considered noninformative, we make sure the splitting does not stop until all of the samples are asked two questions whose answers are TRUE or FALSE.We have defined real depth of a node as the number of non-NA nodes in the path from the root node to the node in question. Consider traversing from the root node,to the node in question; at any node, if the feature value for the split is NA, the NA child node is traversed and real depth stays the same. If the feature is available, one traverses to the left or right node and real depth increases by 1. To make sure a minimum number of real questions have been asked , that is, each of the set of samples have been sent down the non-NA branches at least $d$ times, we set the minimum real depth parameter to $d$. In most of our experiments,we choose the $d$ parameter as 2 The node splitting does not stop until all instances are nodes that have real depths that are greater or equal to 2.</p>

<p>Given the training samples and the class labels for those samples</p>

<ul>
<li><p>Initialize a new tree with a root node</p></li>

<li><p>Collect all of the samples in the root node</p></li>

<li><p>For every leaf node, until all of the leaf nodes have been processed</p>

<ul>
<li><p>If all of the samples are in unsplittable nodes, or nodes that have a real depth larger than the min.real.depth parameter, stop splitting</p></li>

<li><p>If max. depth is reached, or the node is an unsplittable leaf node, skip to next leaf node</p></li>

<li><p>For each possible split in a leaf node,</p>

<ul>
<li>Compute the change in entropy: the conditional entropy of the class random variable given the answer to the query of the split minus the original entropy of the class random variable. The entropies are estimated from the samples for which the feature values are available</li>
</ul></li>

<li><p>Find the best split among the possible splits</p></li>

<li><p>Create three children nodes and mark them as unprocessed : the samples which have available feature values populate the first two children nodes according to their feature values. The third child node which will be traversed to in case of unavailable feature values is populated with all of the samples in the current node.</p></li>

<li><p>Mark the current node as processed</p></li>
</ul></li>

<li><p>Return the resulting tree</p></li>
</ul></li>

<li><p>Modality -Based Trees: It therefore makes sense to divide the dataset into subsets each of which is composed of subjects that contains non-NA feature values for all of the features in a modality group. This approach allows the use of classical decision trees to use only features in the modalities in the chosen group and the subset of data to train a tree where NAs do not appear in any of the queries.Suppose we have three groups of modalities: $A$, $B$ and $C$. Then it is possible to train 8 trees from the eight subsets of a dataset $\mathbf{D}$. Each of the subsets will be define as $\mathbf{D}<em>{S}={\mathbf{D}[i,.]):i\in I,\mathbf{D}[i,x]\neq NA\forall x\, such\, that\, x\in S}$ where $S\in\left{ \left{ A\right} ,\left{ B\right} ,\left{ C\right} ,\left{ A\cup B\right} ,\left{ A\cup C\right} ,\left{ B\cup C\right} ,\left{ A\cup B\cup C\right} \right} $. Note that for Reynolds dataset, $A$=“ SNP”,B=“ ECG”, $C$=“ Imaging” and we preprocess the original dataset of $\mathbf{D</em>{orig}}$. $\mathbf{D}$ is defined as the subset of $\mathbf{D}<em>{orig}$ for which there’s no NA values for the features in $D$=PROTEIN and $E$=“ Clinical”. That is$\mathbf{D}={\mathbf{D}</em>{orig}[i,.]):i\in I\,,\mathbf{\,\mathbf{D}<em>{orig}}[i,x]\neq NA\forall x\, such\, that\, x\in T}$ where $T$=$\left{ D\cup E\right} $ and $\mathbf{D</em>{orig}}$ is the original dataset.</p>

<p>Given the training samples and the class labels for those samples,</p>

<ul>
<li><p>Consider 5 feature modalities( SNP, ECG, Imaging,PROTEIN, Clinical) and 8 groups of modalities that all include PROTEIN AND  Clinical</p></li>

<li><p>Create 8 training sets from the training samples , each composed of the samples that have all of the features in a group of modalities</p></li>

<li><p>For MODAL.GROUP=1:8</p>

<ul>
<li><p>Initialize a new tree with a root node</p></li>

<li><p>In the root node, Collect all of the samples in the training set corresponding to the group of modalities with index MODAL.GROUP</p></li>

<li><p>Until all of the leaf nodes have been processed</p>

<ul>
<li><p>For each possible split in a leaf node, compute the change in entropy: the conditional entropy of the class random variable given the answer to the query of the split minus the original entropy of the class random variable. The entropies are estimated from the samples for which the feature values are available</p></li>

<li><p>Find the best split among the possible splits</p></li>

<li><p>Create two children nodes and mark them as unprocessed : the samples which have available feature values populate the first two children nodes according to their feature values.</p></li>

<li><p>Mark the current node as processed</p></li>
</ul></li>
</ul></li>
</ul></li>
</ol>

<p>Given the feature values for a patient, and the trained decision tree with the split rules and decision rules,and a decision threshold:</p>

<ul>
<li><p>Starting from the root node, until a leaf node is reached</p>

<ul>
<li>Choose one of the children nodes to proceed to, based on the split rule</li>
</ul></li>

<li><p>The predicted risk score for the given patient is the risk score of the leaf node.</p></li>

<li><p>Classify the patient according to whether the predicted risk score is larger or smaller than the given decision threshold.</p></li>
</ul>

<p>Return the class label</p>

<p>Given the feature values for a patient, and the trained Modality-Based decision trees with the split rules and decision rules and a decision threshold:</p>

<ul>
<li><p>Determine which feature modalities are available for the patient and all possible groups of these modalities.</p></li>

<li><p>For each of the groups of modalities and its corresponding modality-based tree,</p>

<ul>
<li>Run the decision tree prediction algorithm, to compute the predicted risk score for an individual tree.</li>
</ul></li>

<li><p>Compute average of the predicted risk score from individual trees.</p></li>

<li><p>Compare the average with the given decision threshold to predict the class label.</p></li>
</ul>

<p>Return the predicted class label</p>

<h2 id="split-criterion-split-criterion-unnumbered">Split Criterion {#split-criterion .unnumbered}</h2>

<p>During training decision trees, some criterion based on the class distribution in a node is used to decide the way the node should be split(which feature and what threshold value should be used) . One of the more popular criteria is the change in entropy between original entropy of the dependent(class) variable and conditional entropy( conditioned on the split query). N/A feature values prove to be a challenge in the computation of these quantities. If one assumes N/A answer to the split query is informative, “N/A” could be treated as another possible answer to the split query. It is then natural to consider a ternary split in the node, in which the extra child for the split node is populated by subjects with N/A answers to the query. In fact, our initial version of decision trees (dubbed as NA Trees) designed to solve the missing data problem worked in such fashion. It is similar to a possible approach to missing value problem, treating NAs as another categorical variable value. In our application problem, the assumption of informative N/A values is undesirable. Therefore the entropy split criterion for a candidate feature is computed based on the subjects with a non-N/A value for that feature. In case of modality-based trees, there is no necessity for consideration of N/A values, since ,for each group of modality , the dataset is filtered to have have no N/As for the features in that group.</p>

<h2 id="feature-selection-feature-selection-unnumbered">Feature Selection {#feature-selection .unnumbered}</h2>

<p>For the experiments, a subset of these features are used which have been deemed relevant by cardiovascular experts. These features are divided into two groups, according to the the experts’ certainty of association with SCD and/or ICD firing.</p>

<p>Primary Expert Features :  SNP1 , SNP3 ,LVEF, DEmass ,SDNN_msec , LFdivHFplLF , QTVI_log ,Inducible , Race ,ECHOEF , HS.CRP, TNF.a.Rec.2, HSIL.6 ,Pro.BNP ,Il.10, CTNT ,CKNB ,Myoglobin, Tropin.I</p>

<p>Secondary Expert Features:  SNP2,  SNP6 ,LVEDV, QTintmean_sec ,meanNN_msec, Gender ,Age.At.Implant</p>

<h2 id="results-and-plots-results-and-plots-unnumbered">Results and Plots {#results-and-plots .unnumbered}</h2>

<p>15 runs of cross-validated training and testing sessions were carried out. By using different threshold values for the binary decision during the testing step, different sensitivity and specificity values for the two decision tree algorithms were found. Figure 1 shows the obtained points which form the ROC curve.</p>

<p>Both types of decision trees are trained on a portion of the dataset and tested on the remaining portion with each class decision threshold value. For each threshold value, different class predictions might be made, so the number of true positives and false negatives change for each class decision threshold. The number of true positives and true negatives are recorded for each threshold value separately. Finally, sensitivity and specificity is computed from the number of true positives and true negatives for each threshold value. Multiple runs of cross-validations increase the number of available ROC points(points whose coordinates are sensitivity , 1-specificity pairs).</p>

<p><img src="modality_vs_substitute_Trees" alt="Points on the ROC curves for the two decision tree types\
Predicted phenotype is Death event within 545 days after implantation." /></p>

<h3 id="comparison-of-novel-tree-algorithms-with-currently-used-biomarkers-in-cardiovascular-community .unnumbered">Comparison of Novel Tree Algorithms with currently used biomarkers in cardiovascular community</h3>

<p>One of our aims in this project was to have interpretable classifiers that would improve the current practices of the cardiovascular community.To validate our accomplishment of this goal, we tested the two novel decision tree algorithms we devised and the ejection fraction biomarker( used in deciding whether a patient needs an ICD device) In this experiment, we are testing the prediction of Death event within 545 days in the population that Modality-Based Trees are valid for(PROTEIN and  Clinical features are all available).</p>

<p><img src="ROCcomparisonofModal_TreeSubst_TreeSingFeature" alt="" /></p>

<p>The following trees are generated when the training algorithm is applied to all of the available data. The following tree (Fig. 2) is the result of substitute tree algorithm. Figures 3,4 and 5 are three examples of modality-based trees with codes 000,100,010(The binary digits show the presence of the modalities  SNP, ECG, Imaging ,respectively, in the group)</p>

<h2 id="evaluation-of-our-missing-data-handling-method-subst-tree-vs-probabilistic-split-of-c4-5-evaluation-of-our-missing-data-handling-methodsubst-tree-vs-probabilistic-split-of-c4-5-unnumbered">Evaluation of Our Missing Data Handling Method(Subst Tree) vs Probabilistic Split of C4.5 {#evaluation-of-our-missing-data-handling-methodsubst-tree-vs-probabilistic-split-of-c4.5 .unnumbered}</h2>

<p>Due to the novelty of the missing data method we employ, it is necessary to validate this method by comparing its performance with other missing data methods, such as the probabilistic split method used in C4.5 trees. The results of cross-validated simulations for Substitute Trees and C4.5 Trees is compared. We try different depth parameters for the trees. The two parameters controlling the decision to split a leaf node is : max.depth, and min.real.depth. min.real.depth is the minimum number of questions an instance gets asked unless it ends up in a pure node(either a node populated by too little number of positive instances, or no positive instances) in the final tree after stopping splits. max.depth is the maximum depth any leaf node can have.If all the leaf nodes reach max.depth, the splitting stops. For the Reynolds dataset, the tree shown shows a decision tree trained using all available data with parameters max.depth=3 and min.real.depth = 2</p>

<p><img src="SubstTrees_Vary_Depth" alt="Trees With Substitute Subtrees" /></p>

<p><img src="c4_5Trees_Vary_Depth" alt="Unpruned C4.5 Trees" /></p>

<p><img src="Subst_Tree_C4_5_Comparison_Vary_Depths" alt="" /></p>

<p>An alternative dataset is also used to see whether any difference (or lack of) between the two missing data handling is specific to the Reynolds dataset. The dataset that is used is “Multiple Feature” dataset available in UCI Machine Learning Repository@Asuncion+Newman:2007 .The dataset consists of features extracted from handwritten digits. This dataset was chosen because the attributes are grouped in different <em>modalities</em>.</p>

<ol>
<li><p>mfeat-fou: 76 Fourier coefficients of the character shapes;</p></li>

<li><p>mfeat-fac: 216 profile correlations;</p></li>

<li><p>mfeat-kar: 64 Karhunen-Love coefficients;</p></li>

<li><p>mfeat-pix: 240 pixel averages in 2 x 3 windows;</p></li>

<li><p>mfeat-zer: 47 Zernike moments;</p></li>

<li><p>mfeat-mor: 6 morphological features.</p></li>
</ol>

<p>The class label in the dataset was changed(TRUE if the digit was 0, FALSE if the digit was not 0) to make it appropriate for a binary classification problem.Since the decision to use the missing data method we have incorporated into the decision tree algorithm was guided by the specific structure of the Reynolds dataset(in general, medical datasets of multiple modalities), we decrease the sample size of the given “Multiple Feature” dataset ,decrease the number of features( a fixed proportion of features from each modality are removed randomly), introduce missing values to all features of a certain modality for randomly selected patients. The missing data rate is different for each modality. We then do cross-validation simulations of Subst Trees and C4.5 Trees of fixed depth. C4.5 trees have maximum depths 4,3,2,1 and are unpruned(The leaf nodes are split until the tree reaches the maximum depth unless the node is pure, or the node has the minimum allowed number of instances ). A constraint similar to the minimum allowed number of instances exist for splitting in Subst Tree algorithm: a node is not split according to a feature, if the number of instances belonging to minority class with that feature available is below a minimum threshold. Therefore, nodes ca not contain smaller number of instances than two times this threshold, and features with too many missing values are not selected during the search for best split. Therefore the two tree algorithms are on a equal setting, and the main difference is the missing data method. The following plot is the comparison of performance for different tree algorithms/parameters.</p>

<p><img src="Realworlddataset_subst_vs_c4_5_final" alt="Unpruned C4.5 Trees on Multiple Features Dataset" /></p>

<p>The original dataset consists of 200 positive instances and 1800 negative instances and the number of samples are reduced from to $\frac{1}{5}$th of their original counts(400 in total). For each of the 6 modalities, $\frac{1}{20}$th of the features in a modality are randomly selected. For each modality, feature values are changed to missing for fractions of 0.05, 0.15, 0.2, 0.3, 0.4, 0.5,respectively, of the instances.</p>

<h2 id="performance-of-trees-on-alternative-phenotypes-performance-of-trees-on-alternative-phenotypes-unnumbered">Performance of Trees on Alternative Phenotypes {#performance-of-trees-on-alternative-phenotypes .unnumbered}</h2>

<p>Various other phenotypes are of relevance.[sub:Phenotype] A natural question would be to see how well the trees perform when they are trained on the original phenotype(Death event within 545 days) and tested on different phenotypes such as Appropriate Firing, Firing,etc.. also within 545 days. This would give an idea of how informative the trees are with respect to different heart disease events, and whether alternative phenotypes can be substituted with the original phenotype in case it’s impossible or prohibitively expensive to collect data for the original phenotype outcome.</p>

<p>For this experiment, only patients who have been implanted for 545 days at the end of the study have been included , as before. Decision trees of the two types were trained on this dataset. These two decision trees were then tested to predict alternative phenotypes( such as death within 1095 days, firing, appropriate firing, sudden death OR appropriate firing,&hellip; within 545 days) If a phenotype is not defined for some of the patients, those patients are removed from testing. By varying the class decision threshold value, we get an ROC curve for each alternative phenotype. No cross-validation takes place for this simulation.</p>

<p><img src="ROCcurves_for_ModalTrees_on_Alt_Phenotype" alt="Performance of Modality-Based Trees on Alternative Phenotypes" /></p>

<p><img src="subst_tree_on_alt_phenotype" alt="Performance of Trees with Substitute Subtrees on Alternative Phenotypes" /></p>

<h2 id="performance-of-modality-based-binary-trees-on-subsamples-performance-of-modality-based-binary-trees-on-subsamples-unnumbered">Performance of Modality-Based Binary Trees on subsamples {#performance-of-modality-based-binary-trees-on-subsamples .unnumbered}</h2>

<p>Each binary tree that is generated in the Modality-Based Trees algorithm is trained on a subset of the whole dataset.(A subset consists of all the instances that has the features in a group of modalities). We should note these subsets are usually overlapping. Most of the patients have all of the PROTEIN and  Clinical features. If the dataset is limited to patients having all of these features, only a small number of patients will be excluded. To keep the number of trees that need to be trained to a minimum, we limit the dataset to patients who have these features, and different modality groups are defined as subsets of { SNP, ECG, Imaging} modalities. These groups are coded as a 3-digit binary numbers. To answer the question of which of the trees generated might be more dependable as a classifier, cross-validated performance measures were computed for each of these binary trees. The algorithm is defined in [alg:Computation-of-Performance]. For each run of the simulation, each modality group of features and the instances for which those features in the group were available for were considered as a separate dataset. Multiple cross-validated training/testing session were run using each such dataset. An ROC curve(averaged) was drawn for each dataset in [fig:Average-of-ROC].</p>

<ul>
<li><ul>
<li>For each run of cross-validation, sim =1:NUM_SIMS</li>
</ul>

<ul>
<li><p>For each group of modalities being considered, MODAL.CODE =1:8</p>

<ul>
<li><p>Set DATASET.MODAL to subset of data for which MODAL.AVAILABLE is true for all of the modalities in the group with code MODAL.CODE</p></li>

<li><p>Set NUM_SAMPLES to size of DATASET.MODAL</p></li>

<li><p>Create a N-partition of 1:NUM_SAMPLES</p></li>

<li><p>For each part of the N-partition, k = 1:N</p>

<ul>
<li><p>Designate samples in kth part(left-out samples) as the validation set</p></li>

<li><p>Designate remaining samples as the training set.</p></li>

<li><p>Train a $\mbox{\emph{BINARY}}$ tree on the training set</p></li>

<li><p>For each threshold value t = t_1: t_L</p></li>

<li><ul>
<li>For each left-out sample,</li>
</ul></li>

<li><ul>
<li>Determine the leaf node the sample ends up in, by traversing down the tree according to its feature values.</li>
</ul></li>

<li><ul>
<li>Compare the class distribution of the training set in the leaf node with the threshold value t to decide on the class prediction.</li>
</ul></li>

<li><ul>
<li>Compute the performance measures(sensitivity, specificity) for threshold t based on the class predictions and the class labels</li>
</ul></li>
</ul></li>

<li><p>Collect the performance measures for the group with MODAL.CODE for this run of cross-validation</p></li>
</ul></li>
</ul></li>

<li><p>For each group of modalities being considered, MODAL.CODE =1:8</p>

<ul>
<li>Collect performance measures for the group with MODAL.CODE over all of the runs. Use this collection of ROC points to draw an average curve for the group.</li>
</ul></li>
</ul>

<p>The resulting ROC curves can be seen in Fig. 6. The legends show the color coding of the feature modalities.. A digit of 1 for a modality represents all the features in that modality have non-NA values.</p>

<p><img src="ROCRcurves-Modality_Treeexpert_Death-545" alt="\[fig:Average-of-ROC\]Average of ROC curves for each group of modalities" /></p>

<p>The sample sizes, and distribution of the classes are as follows in the root nodes for each modality tree.</p>

<p>|  SNP/ ECG/ Imaging<sup class="footnote-ref" id="fnref:1"><a rel="footnote" href="#fn:1">1</a></sup> | Positive Phenotype | Negative Phenotype | Total Sample Size|
| 000 | 29 | 411 | 440|
| 100 | 20 | 301 | 321|
| 010 | 22 | 280 | 302|
| 001 | 6 | 139 | 145|
| 110 | 18 | 255 | 273|
| 101 | 4 | 100 | 104|
| 011 | 4 | 88 | 92|
| 111 | 3 | 58 | 61|
| Original Dataset<sup class="footnote-ref" id="fnref:2"><a rel="footnote" href="#fn:2">2</a></sup> | | | |</p>

<h2 id="performance-on-death-within-1095-days-phenotype-performance-on-death-within-1095-days-phenotype-unnumbered">Performance on “Death Within 1095 Days” phenotype {#performance-on-death-within-1095-days-phenotype .unnumbered}</h2>

<p>We’ve also run different decision tree algorithm for one of the alternative phenotypes: Death within 1095 Days. The dataset we utilize is a subset of the dataset “Death Within 545 Days” phenotype, since there are less patients who have been observed for at least 3 years The sample size is 54 for the positive phenotype(Death event within 1095 days) and 329 for the negative phenotype for a total of 383 patients.</p>

<p><img src="1095_days-SubstTree_MaxD_3-MinD_2" alt="These points on the ROC curve illustrate how Substitute Trees with a maximum depth of 3 and minimum real depth of 2 perform." /></p>

<p><img src="1095_days-SubstTreeaggregate_plot.png" alt="These plots of ROC curves compare how Substitute Trees and C4.5 trees with different depth parameters perform." /></p>

<p><img src="1095_days-Subst_C4_5aggregate_plot" alt="These plots of ROC curves compare how Substitute Trees and C4.5 trees with different depth parameters perform." /></p>

<p><img src="1095_days-REPTreeaggregate_plot" alt="These plots of ROC curves compare how Substitute Trees and C4.5 trees with different depth parameters perform." /></p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:1">PROTEIN and  Clinical modalities must present in all of these subsets of the dataset except Original Dataset
 <a class="footnote-return" href="#fnref:1"><sup>^</sup></a></li>
<li id="fn:2">Patients who have been implanted for 545 days
 <a class="footnote-return" href="#fnref:2"><sup>^</sup></a></li>
</ol>
</div>
</div>

</div>

<div class="container">
  <nav>
  <ul class="pager">
    
    <li class="previous"><a href="https://adalisan.github.io/publication/fidcommjofc/"><span
      aria-hidden="true">&larr;</span> Fidelity-Commensurability Tradeoff in Joint Embedding of Disparate Dissimilarities</a></li>
    

    
  </ul>
</nav>

</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2016 Sancar Adali &middot; 

      Powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic
      theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="/js/jquery-1.12.3.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="/js/hugo-academic.js"></script>
    

    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    <script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML"></script>
    

  </body>
</html>

